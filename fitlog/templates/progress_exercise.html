{% extends "base.html" %}
{% block title %}Fortschritt – Übungsverlauf{% endblock %}

{% block content %}
<h2>Trainingsfortschritt</h2>

<form method="get" action="{{ url_for('progress.exercise_page') }}" class="form-grid">
  <label>Diagramm</label>
  <div>Leistung über Zeit</div>

  <a class="btn-ghost" href="{{ url_for('index') }}" style="justify-self:end">X</a>

  <label for="exercise_id">Übung:</label>
  <select id="exercise_id" name="exercise_id" onchange="this.form.submit()">
    <option value="">Auswählen</option>
    {% for eid, ename in exercises %}
      <option value="{{ eid }}" {{ 'selected' if selected_exercise==eid else '' }}>{{ ename }}</option>
    {% endfor %}
  </select>

  <div></div>
  {% if selected_exercise %}
    <a class="btn" href="{{ url_for('progress.exercise_chart_png', exercise_id=selected_exercise, download=1) }}">Export</a>
  {% else %}
    <span></span>
  {% endif %}

  <div class="chart-frame">
    {% if selected_exercise %}
      <img
        alt="Zeitverlauf"
        src="{{ url_for('progress.exercise_chart_png', exercise_id=selected_exercise) }}"
        class="chart-img" />
    {% else %}
      <div class="chart-placeholder">Bitte eine Übung auswählen.</div>
    {% endif %}
  </div>

  <div></div>
  <a class="btn" href="{{ url_for('progress.select_page') }}">Zurück</a>
</form>

<style>
  .form-grid {
    display: grid;
    grid-template-columns: 10rem 20rem 1fr auto;
    gap: .75rem 1rem;
    align-items: center;
    margin-top: .5rem;
  }
  .btn { padding: .4rem .8rem; border: 1px solid #999; background: #eee; text-decoration: none; }
  .btn-ghost { padding: .25rem .5rem; border: 1px solid #999; background: transparent; text-decoration: none; }
  .chart-frame { grid-column: 1 / -1; margin-top: .5rem; padding: .75rem; background: #eee; border: 1px solid #bbb; }
  .chart-img { width: 100%; max-width: 900px; height: auto; display: block; border: 1px solid #aac; background: #eef; }
  .chart-placeholder { padding: 2rem; color: #666; }
  @media (max-width: 700px) {
    .form-grid { grid-template-columns: 1fr 1fr; }
  }
</style>
{% endblock %}
